})
lapply(names(E5qhima_pls), function(var) {
print(E5qhima_pls[[var]])
})
E5MCP30th_effect_cor
E5MCP50th_effect_cor
E5MCP70th_effect_cor
e5
E5MCP30th_effect_outcome_cor <- perform_cor_tests(E5MCP30th, c(e5[e5[,"tau"] == 0.3,"ID"], "Direct", "Residuals"), "Outcome", alternative = "two.sided", method = "spearman")
E5MCP50th_effect_outcome_cor <- perform_cor_tests(E5MCP50th, c(e5[e5[,"tau"] == 0.5,"ID"], "Direct", "Residuals"), "Outcome", alternative = "two.sided", method = "spearman")
E5MCP70th_effect_outcome_cor <- perform_cor_tests(E5MCP70th, c(e5[e5[,"tau"] == 0.7,"ID"], "Direct", "Residuals"), "Outcome", alternative = "two.sided", method = "spearman")
E5MCP30th_effect_outcome_cor
E5MCP50th_effect_outcome_cor
E5MCP70th_effect_outcome_cor
E5MCP30th_effect_outcome_cor
E5MCP50th_effect_outcome_cor
E5MCP30th_effect_outcome_cor
E5MCP50th_effect_outcome_cor
E5MCP30th_effect_outcome_cor
E5qhima30th_effect_age_cor
E5qhima30th_effect_age_cor
E5MCP30th_effect_age_cor <- perform_cor_tests(E5MCP30th, c(e5[e5[,"tau"] == 0.3,"ID"], "Direct", "Residuals"), "Age", alternative = "two.sided", method = "spearman")
E5MCP50th_effect_age_cor <- perform_cor_tests(E5MCP50th, c(e5[e5[,"tau"] == 0.5,"ID"], "Direct", "Residuals"), "Age", alternative = "two.sided", method = "spearman")
E5MCP70th_effect_age_cor <- perform_cor_tests(E5MCP70th, c(e5[e5[,"tau"] == 0.7,"ID"], "Direct", "Residuals"), "Age", alternative = "two.sided", method = "spearman")
E5MCP30th_effect_age_cor
E5MCP50th_effect_age_cor
E5MCP70th_effect_age_cor
E5MCP50th_effect_age_cor
E5MCP30th_treatment_res_cor <- cor.test(E5MCP30th$Treatment, E5qhima30th$Residuals,method = "spearman", alternative = "two.sided")
E5MCP70th_treatment_res_cor <- cor.test(E5MCP70th$Treatment, E5MCP70th$Residuals,method = "spearman", alternative = "two.sided")
E5MCP50th_treatment_res_cor <- cor.test(E5MCP50th$Treatment, E5MCP50th$Residuals,method = "spearman", alternative = "two.sided")
E5MCP30th_treatment_res_cor
E5MCP50th_treatment_res_cor
E5MCP70th_treatment_res_cor
E5MCP30th_treatment_res_cor
E5MCP30th_treatment_res_cor <- cor.test(E5MCP30th$Treatment, E5MCP30th$Residuals,method = "spearman", alternative = "two.sided")
E5MCP30th_treatment_res_cor
E5MCP50th_treatment_res_cor
E5MCP70th_treatment_res_cor
E5MCP30th_treatment_res_cor
E5MCP50th_treatment_res_cor
E5MCP70th_treatment_res_cor
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
e5
e5$tau
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5qhima30th_kruskal_sex <- perform_kruskal(E5qhima30th, "Sex", c(qHIMA.fit[qHIMA.fit$tau == 0.3,"Index"], "Direct", "Outcome", "Residuals"))
E5qhima50th_kruskal_sex <- perform_kruskal(E5qhima50th, "Sex", c(qHIMA.fit[qHIMA.fit$tau == 0.5,"Index"], "Direct", "Outcome", "Residuals"))
E5qhima70th_kruskal_sex <- perform_kruskal(E5qhima70th, "Sex", c(qHIMA.fit[qHIMA.fit$tau == 0.7,"Index"], "Direct", "Outcome", "Residuals"))
E5MCP30th
e5[e5$tau == 0.7,"ID"]
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th_kruskal_sex <- perform_kruskal(E5qhima30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c("M1", "Direct", "Outcome", "Residuals"))
head(E5MCP30th)
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c("M1", "Direct", "Outcome", "Residuals"))
dim(E5MCP30th)
E5MCP30th[,"Sex"]
length(E5MCP30th[,"Sex"])
length(E5MCP30th[,"M1"])
E5MCP30th_kruskal_sex
E5MCP30th_kruskal_sex <- NULL
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP50th_kruskal_sex <- perform_kruskal(E5MCP50th, "Sex", c(e5[e5$tau == 0.5,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP70th_kruskal_sex <- perform_kruskal(E5MCP70th, "Sex", c(e5[e5$tau == 0.7,"ID"], "Direct", "Outcome", "Residuals"))
E5qhima30th_kruskal_sex
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP50th_kruskal_sex <- perform_kruskal(E5MCP50th, "Sex", c(e5[e5$tau == 0.5,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP70th_kruskal_sex <- perform_kruskal(E5MCP70th, "Sex", c(e5[e5$tau == 0.7,"ID"], "Direct", "Outcome", "Residuals"))
E5qhima30th_kruskal_sex
E5qhima50th_kruskal_sex
E5MCP30th_kruskal_sex
kruskal.test(E5MCP30th$Sex, E5MCP30th$M1)
kruskal.test(E5MCP30th$Sex, E5MCP30th$Direct)
kruskal.test(E5MCP30th$M1, E5MCP30th$Sex)
kruskal.test(E5MCP30th$Direct, E5MCP30th$Sex)
kruskal.test(E5MCP30th$Outcome, E5MCP30th$Sex)
kruskal.test(E5MCP30th$Residuals, E5MCP30th$Sex)
E5MCP50th_kruskal_sex
E5MCP70th_kruskal_sex
E5MCP50th_kruskal_sex
E5MCP30th_kruskal_sex
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th
E5MCP30th
E5MCP30th <- estimatedEffects(fit = e5[e5$tau == 0.3,],
IDEcoefs = e5[e5$tau==0.3,"alpha*beta"],
betas = e5[e5$tau == 0.3,"beta"],
type = "continuous",
dat = himaDat$Example5,
X = himaDat$Example5$PhenoData$Treatment,
Y = himaDat$Example5$PhenoData$Outcome,
Cov = himaDat$Example5$PhenoData[, c("Sex", "Age")])
E5MCP30th <- E5MCP30th[E5MCP30th$Outcome <= quantile(E5MCP30th$Outcome,0.3),]
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th
E5mcp_pls <- list()
E5MCP30th
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th[,"Sex"]
length(E5MCP30th[,"Sex"])
length(E5MCP30th[,"M1"])
length(E5MCP30th[,"Direct"])
length(E5MCP30th[,"Outcome"])
length(E5MCP30th[,"Residuals"])
source("functions.pck")
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP50th_kruskal_sex <- perform_kruskal(E5MCP50th, "Sex", c(e5[e5$tau == 0.5,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP70th_kruskal_sex <- perform_kruskal(E5MCP70th, "Sex", c(e5[e5$tau == 0.7,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
e5[e5$tau == 0.3,"ID"]
E5MCP50th_kruskal_sex <- perform_kruskal(E5MCP50th, "Sex", c(e5[e5$tau == 0.5,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP70th_kruskal_sex <- perform_kruskal(E5MCP70th, "Sex", c(e5[e5$tau == 0.7,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th[,c(e5[e5$tau == 0.5,"ID"], "Direct", "Outcome", "Residuals")]
E5MCP30th[,c("Direct", "Outcome", "Residuals")]
c(e5[e5$tau == 0.5,"ID"], "Direct", "Outcome", "Residuals")
E5MCP30th[,c(c(e5[e5$tau == 0.3,"ID"]), "Direct", "Outcome", "Residuals")]
E5MCP30th[,c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals")]
kruskal.test(E5MCP30th[,c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals")], E5MCP30th$Sex)
kruskal.test(E5MCP30th[,c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals")])
kruskal.test(E5MCP30th$Sex,E5MCP30th[,c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals")])
E5MCP30th[,c("Direct", "Outcome", "Residuals")]
E5MCP30th[,c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals")]
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
e5[e5$tau == 0.3]
e5[e5$tau == 0.3, "ID"]
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3, "ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP50th_kruskal_sex <- perform_kruskal(E5MCP50th, "Sex", c(e5[e5$tau == 0.5,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP70th_kruskal_sex <- perform_kruskal(E5MCP70th, "Sex", c(e5[e5$tau == 0.7,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c("Direct", "Outcome", "Residuals"))
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c("M1", "Direct", "Outcome", "Residuals"))
E5MCP30th[,c(e5[e5$tau == 0.3, "ID"],Direct", "Outcome", "Residuals")]
E5MCP30th[,c(e5[e5$tau == 0.3, "ID"], "Direct", "Outcome", "Residuals")]
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c("Adjusted", "Direct", "Outcome", "Residuals"))
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP50th_kruskal_sex <- perform_kruskal(E5MCP50th, "Sex", c(e5[e5$tau == 0.7,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.5,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
kruskal.test(M1 ~ Sex, data = E5MCP30th)
E5MCP30th[,"M1"]
E5MCP30th[,e5[e5$tau == 0.3,"ID"]]
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals","Treatment"))
E5MCP30th
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c("Direct", "Outcome", "Residuals",e5[e5$tau == 0.3,"ID"]))
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c("Direct", "Outcome", "Residuals",e5[e5$tau == 0.3,"ID"]))
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
source("functions.pck")
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
perform_kruskal(E5MCP30th, "Sex", c("Direct", "Outcome", "Residuals"))
perform_kruskal(E5MCP30th, "Sex", c("Direct", "Outcome", "Residuals", e5[e5$tau == 0.3, "ID"]))
perform_kruskal(E5MCP30th, "Sex", c("Direct", "Outcome", "Residuals", "M1"))
perform_kruskal(E5MCP30th, "Sex", c("Direct", "Outcome", "Residuals", "M2"))
perform_kruskal(E5MCP30th, "Sex", c("Direct", "Outcome", "Residuals", "M1"))
E5MCP30th$M1
cols(E5MCP30th)
colnames(E5MCP30th)
perform_kruskal(E5MCP30th, "Sex", colnames(E5MCP30th))
perform_kruskal(E5MCP30th, "Sex", colnames(E5MCP30th))
E5MCP30th[,"M1" ]
E5MCP30th[,"M1"]
E5MCP50th[,"M2"]
E5MCP50th[,"M1"]
E5MCP30th[,"M1"]
E5MCP50th[,"M2"]
summary(E5MCP50th[,"M2"])
(E5MCP30th[,"Treatment"])
(E5MCP30th[,"Sex"])
str(E5MCP30th[,"Sex"])
str(E5MCP30th[,"M1"])
str(E5MCP30th[,"Outcom"])
str(E5MCP30th[,"Outcome"])
source("functions.pck")
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th <- estimatedEffects(fit = e5[e5$tau == 0.3,],
IDEcoefs = e5[e5$tau == 0.3, "alpha*beta"],
betas = e5[e5$tau == 0.3,"beta"],
type = "continuous",
dat = himaDat$Example5,
X = himaDat$Example5$PhenoData$Treatment,
Y = himaDat$Example5$PhenoData$Outcome,
Cov = himaDat$Example5$PhenoData[, c("Sex", "Age")])
E5MCP30th <- E5MCP30th[E5MCP30th$Outcome <= quantile(E5MCP30th$Outcome,0.3),]
E5mcp_pls[["30th"]] <- plot_mediator_adjustments(actual = himaDat$Example5$PhenoData[himaDat$Example5$PhenoData$Outcome <= quantile(himaDat$Example5$PhenoData$Outcome, 0.3),]$Outcome,
estimations = E5MCP30th,
mediator_indices = e5[e5$tau == 0.3,"ID"],
plotname = "Example Five 30th Percentile MCP HIMA Outcome Predictions")
source("functions.pck")
E5MCP30th <- estimatedEffects(fit = e5[e5$tau == 0.3,],
IDEcoefs = e5[e5$tau == 0.3, "alpha*beta"],
betas = e5[e5$tau == 0.3,"beta"],
type = "continuous",
dat = himaDat$Example5,
X = himaDat$Example5$PhenoData$Treatment,
Y = himaDat$Example5$PhenoData$Outcome,
Cov = himaDat$Example5$PhenoData[, c("Sex", "Age")])
E5MCP30th <- estimatedEffects(fit = e5[e5$tau == 0.3,],
IDEcoefs = e5[e5$tau == 0.3, "alpha*beta"],
betas = e5[e5$tau == 0.3,"beta"],
type = "continuous",
dat = himaDat$Example5,
X = himaDat$Example5$PhenoData$Treatment,
Y = himaDat$Example5$PhenoData$Outcome,
Cov = himaDat$Example5$PhenoData[, c("Sex", "Age")])
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals", drop = FALSE))
E5MCP30th[["Sex"]]
E5MCP30th[["M1"]]
E5MCP30th[["M1"]]
E5MCP30th[["M1"]][0]
E5MCP30th[["M1"]][1]
E5MCP30th[["M1"]][0,1]
rownames(E5MCP30th[["M1"]])
E5MCP30th$M1
Example5$Mediator[,c(e5[e5$tau == 0.5,"ID"]]
Example5$Mediator[c(e5[e5$tau == 0.5,"ID"]]
Example5$Mediator[, c(e5[e5$tau == 0.5,"ID"]]
Example5$Mediator[, e5[e5$tau == 0.5,"ID"]]
Example5$Mediator[, e5[e5$tau == 0.3,"ID"]]
data.frame(Example5$Mediator[, e5[e5$tau == 0.3,"ID"]])
c(Example5$Mediator[, e5[e5$tau == 0.3,"ID"]])
c(E5MCP30th[, e5[e5$tau == 0.3,"ID"]])
source("functions.pck")
source("functions.pck")
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals", drop = FALSE))
E5MCP30th$M1
c(E5MCP30th$M1)
E5MCP30th$M1 <- c(E5MCP30th$M1)
E5MCP30th$M1
E5MCP30th[,"M1"]
source("functions.pck")
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals", drop = FALSE))
E5MCP50th_kruskal_sex <- perform_kruskal(E5MCP50th, "Sex", c(e5[e5$tau == 0.5,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th <- estimatedEffects(fit = e5[e5$tau == 0.3,],
IDEcoefs = e5[e5$tau == 0.3, "alpha*beta"],
betas = e5[e5$tau == 0.3,"beta"],
type = "continuous",
dat = himaDat$Example5,
X = himaDat$Example5$PhenoData$Treatment,
Y = himaDat$Example5$PhenoData$Outcome,
Cov = himaDat$Example5$PhenoData[, c("Sex", "Age")])
E5MCP50th <- estimatedEffects(fit = e5[e5$tau == 0.5,],
IDEcoefs = e5[e5$tau == 0.5, "alpha*beta"],
betas = e5[e5$tau == 0.5,"beta"],
type = "continuous",
dat = himaDat$Example5,
X = himaDat$Example5$PhenoData$Treatment,
Y = himaDat$Example5$PhenoData$Outcome,
Cov = himaDat$Example5$PhenoData[, c("Sex", "Age")])
E5MCP30th <- estimatedEffects(fit = e5[e5$tau == 0.3,],
IDEcoefs = e5[e5$tau == 0.3, "alpha*beta"],
betas = e5[e5$tau == 0.3,"beta"],
type = "continuous",
dat = himaDat$Example5,
X = himaDat$Example5$PhenoData$Treatment,
Y = himaDat$Example5$PhenoData$Outcome,
Cov = himaDat$Example5$PhenoData[, c("Sex", "Age")])
c(Example5$Mediator[,c("M1","M2")])
c(Example5$Mediator[,c("M1")])
c(c(Example5$Mediator[,c("M1")]))
str(c(Example5$Mediator[,c("M1")]))
c(Example5$Mediator[,c("M1")])
as.vector(Example5$Mediator[,c("M1")])
as.vector(Example5$Mediator[,c("M1","M2")])
source("functions.pck")
E5MCP30th <- estimatedEffects(fit = e5[e5$tau == 0.3,],
IDEcoefs = e5[e5$tau == 0.3, "alpha*beta"],
betas = e5[e5$tau == 0.3,"beta"],
type = "continuous",
dat = himaDat$Example5,
X = himaDat$Example5$PhenoData$Treatment,
Y = himaDat$Example5$PhenoData$Outcome,
Cov = himaDat$Example5$PhenoData[, c("Sex", "Age")])
E5MCP30th <- E5MCP30th[E5MCP30th$Outcome <= quantile(E5MCP30th$Outcome,0.3),]
E5MCP50th <- estimatedEffects(fit = e5[e5$tau == 0.5,],
IDEcoefs = e5[e5$tau == 0.5, "alpha*beta"],
betas = e5[e5$tau == 0.5,"beta"],
type = "continuous",
dat = himaDat$Example5,
X = himaDat$Example5$PhenoData$Treatment,
Y = himaDat$Example5$PhenoData$Outcome,
Cov = himaDat$Example5$PhenoData[, c("Sex", "Age")])
E5MCP50th <- E5MCP50th[E5MCP50th$Outcome <= quantile(E5MCP50th$Outcome,0.5),]
E5MCP70th <- estimatedEffects(fit = e5[e5$tau == 0.5,],
IDEcoefs = e5[e5$tau == 0.5, "alpha*beta"],
betas = e5[e5$tau == 0.5,"beta"],
type = "continuous",
dat = himaDat$Example5,
X = himaDat$Example5$PhenoData$Treatment,
Y = himaDat$Example5$PhenoData$Outcome,
Cov = himaDat$Example5$PhenoData[, c("Sex", "Age")])
E5MCP70th <- E5MCP70th[E5MCP70th$Outcome <= quantile(E5MCP70th$Outcome,0.7),]
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
as.vector(E5MCP30th$M1)
source("functions.pck")
E5MCP30th_kruskal_sex <- perform_kruskal(E5MCP30th, "Sex", c(e5[e5$tau == 0.3,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP50th_kruskal_sex <- perform_kruskal(E5MCP50th, "Sex", c(e5[e5$tau == 0.5,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP70th_kruskal_sex <- perform_kruskal(E5MCP70th, "Sex", c(e5[e5$tau == 0.7,"ID"], "Direct", "Outcome", "Residuals"))
E5MCP30th_kruskal_sex
E5MCP30th_kruskal_sex
E5MCP50th_kruskal_sex
E5MCP70th_kruskal_sex
E2classicmodelpl
source("functions.pck")
E2classic <- estimatedEffects(fit = hima.logistic.fit,
type = "binary",
dat = himaDat$Example2,
X = himaDat$Example2$PhenoData$Treatment,
Y = himaDat$Example2$PhenoData$Disease,
Cov = himaDat$Example2$PhenoData[, c("Sex", "Age")])
E2classicmodelpl <- plot_mediator_adjustments(type = "binary",
actual = himaDat$Example2$PhenoData$Disease,
estimations = E2classic,
mediator_indices = hima.logistic.fit[,"Index"],
plotname = "Example Two Classic HIMA Outcome Predictions",
labels = c("Disease", "Negative", "Positive"))
E2classicmodelpl
E2classic_effect_cor <- perform_cor_tests(E2classic, c(hima.logistic.fit[,"Index"]), alternative = "two.sided", method = "spearman")
E2classic_effect_cor
E2classic_effect_cor_e <- perform_cor_tests(E2classic[E2classic$Treatment != 0,], c(hima.logistic.fit[,"Index"], "Direct"), alternative = "two.sided", method = "spearman")
E2classic_effect_cor_e
E2classic_effect_lor_cor <- perform_cor_tests(E2classic, x = c(hima.logistic.fit[,"Index"], "Direct"), y = "Adjusted", alternative = "two.sided", method = "spearman")
E2classic_effect_lor_cor
E2classic_effect_age_cor <- perform_cor_tests(E2classic, x = c(hima.logistic.fit[,"Index"], "Direct"), y = "Age", alternative = "two.sided", method = "spearman")
E2classic_effect_age_cor
E2classic_kruskal_sex <- perform_kruskal(E2classic, "Sex", c(hima.logistic.fit[,"Index"], "Direct", "Adjusted"))
E2classic_kruskal_sex
E2classic$Sex <- ifelse(E2classic$Sex == 0, "Male", "Female")
E2classic_sex_pl <- plot_violins(E2classic, "Sex", "Direct", plotname = "Example 2 Classic HIMA Direct ~ Sex Violin Plot")
E2classic_sex_pl
boot_tests(E2classic, "Sex", "Direct", mean)
E2classic_kruskal_disease <- perform_kruskal(E2classic, "Disease", c(hima.logistic.fit[,"Index"], "Direct", "Adjusted"))
E2classic_kruskal_disease
E2mcp <- estimatedEffects(fit = e2,
betas = e2[,"beta"],
IDEcoefs = e2[,"alpha*beta"],
type = "binary",
dat = himaDat$Example2,
X = himaDat$Example2$PhenoData$Treatment,
Y = himaDat$Example2$PhenoData$Disease,
Cov = himaDat$Example2$PhenoData[, c("Sex", "Age")])
E2mcpmodelpl <- plot_mediator_adjustments(type = "binary",
actual = himaDat$Example2$PhenoData$Disease,
estimations = E2mcp,
mediator_indices = e2[,"ID"],
plotname = "Example Two MCP HIMA Outcome Predictions",
labels = c("Disease", "Negative", "Positive"))
E2mcpmodelpl
E2mcp_effect_cor <- perform_cor_tests(E2mcp, c(e2[,"ID"]), alternative = "two.sided", method = "spearman")
E2mcp_effect_cor
E2mcp_effect_cor_e <- perform_cor_tests(E2mcp[E2mcp$Treatment > 0,], c(e2[,"ID"], "Direct"), alternative = "two.sided", method = "spearman")
E2mcp_effect_cor_e
E2mcp_experimental_long <- melt(E2mcp[E2mcp$Treatment != 0,c(e2[,"ID"], "Direct")], variable.name = "Effect", value.name = "Contribution")
E2mcp_experimental_long
E2mcp_experimental_pl <- plot_violins(E2mcp_experimental_long, x = "Effect", y = "Contribution", "Example 2 MCP HIMA Experimental Group Effects")
E2mcp_experimental_boot <- boot_tests(data = E2mcp_experimental_long, x = "Effect", y = "Contribution", statistic = mean)
E2mcp_experimental_boot
E2mcp_experimental_pl
E2mcp_effect_lor_cor <- perform_cor_tests(E2mcp, x = c(e2[,"ID"], "Direct"), y = "Adjusted", alternative = "two.sided", method = "spearman")
E2mcp_effect_lor_cor
dblassohima.fit
hima.logistic.fit
qHIMA.fit
c(3,3,3)*c(2,2,2)
rep(0,3)
source("functions.pck")
E1classic <- estimatedEffects()
E1classic <- estimatedEffects()
Example1classicmodelpl <- plot_mediator_adjustments(actual = himaDat$Example1$PhenoData$Outcome,
estimations = E1classic,
mediator_indices = hima.fit[,"Index"],
plotname = "Example One Classic HIMA Outcome Predictions")
Example1classicmodelpl
source("functions.pck")
E1classic <- estimatedEffects()
Example1classicmodelpl <- plot_mediator_adjustments(actual = himaDat$Example1$PhenoData$Outcome,
estimations = E1classic,
mediator_indices = hima.fit[,"Index"],
plotname = "Example One Classic HIMA Outcome Predictions")
Example1classicmodelpl
e5 <- himaFit(Outcome ~ Treatment + Sex + Age,
data.pheno = himaDat$Example5$PhenoData,
data.M = himaDat$Example5$Mediator,
mediator.type = "gaussian",
quantile = TRUE,
penalty = "MCP", # Quantile HIMA does not support DBlasso
scale = FALSE, # Disabled only for simulation data
tau = c(0.3, 0.5, 0.7)
) # Specify multiple quantile level
e5 <- himaFit(Outcome ~ Treatment + Sex + Age,
data.pheno = himaDat$Example5$PhenoData,
data.M = himaDat$Example5$Mediator,
mediator.type = "gaussian",
quantile = TRUE,
penalty = "MCP", # Quantile HIMA does not support DBlasso
scale = FALSE, # Disabled only for simulation data
tau = c(0.3, 0.5, 0.7)
) # Specify multiple quantile level
e5
e5
36.87616 + 29.06033 + 34.05085
39.07191 + 35.37265 + 24.05193
e5$`Relative Importance (%)`
sum(e5$`Relative Importance (%)`)
/3
e5 <- himaFit(Outcome ~ Treatment + Sex + Age,
data.pheno = himaDat$Example5$PhenoData,
data.M = himaDat$Example5$Mediator,
mediator.type = "gaussian",
quantile = TRUE,
penalty = "MCP", # Quantile HIMA does not support DBlasso
scale = FALSE, # Disabled only for simulation data
tau = c(0.3, 0.5, 0.7)
) # Specify multiple quantile level
e5
sum(e5$`Relative Importance (%)`)
40.39331 + 34.13056 + 25.47613
lapply(names(E5mcp_pls), function(var) {
print(E5mcp_pls[[var]])
})
E5MCP30th <- estimatedEffects(fit = e5[e5$tau == 0.3,],
IDEcoefs = e5[e5$tau == 0.3, "alpha*beta"],
betas = e5[e5$tau == 0.3,"beta"],
type = "continuous",
dat = himaDat$Example5,
X = himaDat$Example5$PhenoData$Treatment,
Y = himaDat$Example5$PhenoData$Outcome,
Cov = himaDat$Example5$PhenoData[, c("Sex", "Age")])
E5MCP30th <- E5MCP30th[E5MCP30th$Outcome <= quantile(E5MCP30th$Outcome,0.3),]
E5mcp_pls[["30th"]] <- plot_mediator_adjustments(actual = himaDat$Example5$PhenoData[himaDat$Example5$PhenoData$Outcome <= quantile(himaDat$Example5$PhenoData$Outcome, 0.3),]$Outcome,
estimations = E5MCP30th,
mediator_indices = e5[e5$tau == 0.3,"ID"],
plotname = "Example Five 30th Percentile MCP HIMA Outcome Predictions")
E5MCP50th <- estimatedEffects(fit = e5[e5$tau == 0.5,],
IDEcoefs = e5[e5$tau == 0.5, "alpha*beta"],
betas = e5[e5$tau == 0.5,"beta"],
type = "continuous",
dat = himaDat$Example5,
X = himaDat$Example5$PhenoData$Treatment,
Y = himaDat$Example5$PhenoData$Outcome,
Cov = himaDat$Example5$PhenoData[, c("Sex", "Age")])
E5MCP50th <- E5MCP50th[E5MCP50th$Outcome <= quantile(E5MCP50th$Outcome,0.5),]
E5mcp_pls[["50th"]]<- plot_mediator_adjustments(actual = himaDat$Example5$PhenoData[himaDat$Example5$PhenoData$Outcome <= quantile(himaDat$Example5$PhenoData$Outcome, 0.5),]$Outcome,
estimations = E5MCP50th,
mediator_indices = e5[e5$tau == 0.5,"ID"],
plotname = "Example Five 50th Percentile MCP HIMA Outcome Predictions")
E5MCP70th <- estimatedEffects(fit = e5[e5$tau == 0.5,],
IDEcoefs = e5[e5$tau == 0.5, "alpha*beta"],
betas = e5[e5$tau == 0.5,"beta"],
type = "continuous",
dat = himaDat$Example5,
X = himaDat$Example5$PhenoData$Treatment,
Y = himaDat$Example5$PhenoData$Outcome,
Cov = himaDat$Example5$PhenoData[, c("Sex", "Age")])
E5MCP70th <- E5MCP70th[E5MCP70th$Outcome <= quantile(E5MCP70th$Outcome,0.7),]
E5mcp_pls[["70th"]] <- plot_mediator_adjustments(actual = himaDat$Example5$PhenoData[himaDat$Example5$PhenoData$Outcome <= quantile(himaDat$Example5$PhenoData$Outcome, 0.7),]$Outcome,
estimations = E5MCP70th,
mediator_indices = e5[e5$tau == 0.7,"ID"],
plotname = "Example Five 70th Percentile MCP HIMA Outcome Predictions")
lapply(names(E5mcp_pls), function(var) {
print(E5mcp_pls[[var]])
})
qHIMA.fit <- qHIMA(
X = himaDat$Example5$PhenoData$Treatment,
M = himaDat$Example5$Mediator,
Y = himaDat$Example5$PhenoData$Outcome,
COV = himaDat$Example5$PhenoData[, c("Sex", "Age")],
tau = c(0.3, 0.5, 0.7),
scale = FALSE, # Disabled only for simulation data
Bonfcut = 0.05,
verbose = TRUE
)
e5 <- himaFit(Outcome ~ Treatment + Sex + Age,
data.pheno = himaDat$Example5$PhenoData,
data.M = himaDat$Example5$Mediator,
mediator.type = "gaussian",
quantile = TRUE,
penalty = "MCP", # Quantile HIMA does not support DBlasso
scale = FALSE, # Disabled only for simulation data
tau = c(0.3, 0.5, 0.7)
) # Specify multiple quantile level
knit_with_parameters("C:/Users/Nandish/Desktop/HIMA Demo/HimaDemo.Rmd")
knit_with_parameters("C:/Users/Nandish/Desktop/HIMA Demo/HimaDemo.Rmd")
```{r setup, include=FALSE #+ setup, error=TRUE}
```{r setup, include=FALSE, error=TRUE}
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(echo = TRUE, error=TRUE)
survHIMA.fit
knitr::opts_chunk$set(echo = TRUE, error=TRUE, warning=FALSE)
e1
qHIMA.fit["tau" == 0.3]
qHIMA.fit["tau" == 0.3,]
qHIMA.fit["tau" == 0.3]
qHIMA.fit[,"tau" == 0.3]
qHIMA.fit[,"tau"]
qHIMA.fit["tau" == 0.3,"tau"]
qHIMA.fit[tau == 0.3,"tau"]
qHIMA.fit[,"tau"] == 0.3
qHIMA.fit["tau" == 0.3]
qHIMA.fit[,qHIMA.fit["tau" == 0.3]]
qHIMA.fit[,qHIMA.fit[,"tau" == 0.3]]
qHIMA.fit[,"tau" == 0.3]
qHIMA.fit[,qHIMA.fit$tau == 0.3]
summary(qHIMA.fit[qHIMA.fit$tau == 0.3, "Index"])
summary(qHIMA.fit[qHIMA.fit$tau == 0.3, "Index"])
qHIMA.fit[qHIMA.fit$tau == 0.3, "Index"]
summary(Example5$Mediator[,qHIMA.fit[qHIMA.fit$tau == 0.3, "Index"]])
summary(Example5$Mediator[,qHIMA.fit[, "Index"]])
summary(Example5$Mediator[,unique(qHIMA.fit[, "Index"])])
